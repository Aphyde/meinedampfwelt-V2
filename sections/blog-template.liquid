{% if template == "blog.leftsidebar" %}
  {% assign viewtype = "leftsidebar" %}
{% elsif template == "blog.rightsidebar" %}
  {% assign viewtype = 'rightsidebar' %}
{% elsif template == "blog.withoutsidebar" %}
  {% assign viewtype = 'withoutsidebar' %}
{% else %}
  {% if settings.type_sidebar_blog == 'sidebar_right' %}
    {% assign viewtype = 'rightsidebar' %}
  {% elsif settings.type_sidebar_blog == 'withoutsidebar' %}
    {% assign viewtype = 'withoutsidebar' %}
  {% else %}
    {% assign viewtype = 'leftsidebar' %}
  {% endif %}
{% endif %}
{% if template == "blog.list" %}
  {% assign viewblog = "list" %}
{% elsif template == "blog.column" %}
  {% assign viewblog = 'column' %}
{% elsif template == "blog.grid" %}
  {% assign viewblog = 'grid' %}
{% else %}
  {% if section.settings.layout == 'list' %}
    {% assign viewblog = 'list' %}
  {% elsif section.settings.layout == 'column' %}
    {% assign viewblog = 'column' %}
  {% else %}
    {% assign viewblog = 'grid' %}
  {% endif %}
{% endif %}
{{ 'css-blog.css' | asset_url | stylesheet_tag }}
{% render 'nov-breadcrumb', class_br: "breadcrumb_inner" %}
<div class="container">
  <div class="blog-view-{{ viewtype }} row no-gutters">
    {% if viewtype != 'withoutsidebar' %}
      <div class="sidebar-article col-lg-3 col-md-4 flex-xs-unordered{% if viewtype == 'rightsidebar' %} flex-last{% endif %}">
        {% render 'sidebar-blog' %}
      </div>
    {% endif %}
    <div class="{% if viewtype != 'withoutsidebar' %}col-lg-9 col-md-8 flex-xs-first{% else %}col-lg-12 col-md-12{% endif %}">
      {% if viewblog == "list" %}
        {% paginate blog.articles by section.settings.page_show_list %}
          <div class="blog--list blog--list-view">
            {% for article in blog.articles %}
              <div class="article--listing media">
                <div class="media-image">
                  {% if article.image %}
                    <a href="{{ article.url }}" class="article__list-image-container">
                      {% render 'nov-aspect-image', image: article.image, aspect: 66.67 %}
                    </a>
                  {% endif %}
                </div>
                <div class="media-body">
                  <h2 class="article__title"><a href="{{ article.url }}">{{ article.title }}</a></h2>
                  <div class="article__info">
                    {% if section.settings.blog_show_date %}
                      <span class="article__date">
                        <i class="zmdi zmdi-calendar-note"></i>{{ article.published_at | time_tag: format: 'month_day_year' }}
                      </span>
                    {% endif %}

                    {% if section.settings.blog_show_author %}
                      <span class="article__author"><i class="zmdi zmdi-account"></i>{{ article.author }}</span>
                    {% endif %}

                    {% if section.settings.blog_show_comment %}
                      {% if blog.comments_enabled? %}
                        <span class="article__countcomment">
                          <i class="zmdi zmdi-comments"></i>{{ 'blogs.comments.comments_with_count' | t: count: article.comments_count }}
                        </span>
                      {% endif %}
                    {% endif %}
                  </div>

                  <div class="article__excerpt">
                    {% if article.excerpt.size > 0 %}
                      {{ article.excerpt | strip_html | truncate: 200 }}
                    {% else %}
                      {{ article.content | strip_html | truncate: 200 }}
                    {% endif %}
                  </div>
                  <a href="{{ article.url }}" class="btn">{{ 'blogs.article.readmore' | t }}</a>
                </div>
              </div>
            {% endfor %}
            {% if paginate.pages > 1 %}
            <div class="nov-pagination d-flex align-items-center justify-content-center">
              {% render 'pagination', paginate: paginate %}
            </div>
            {% endif %}
          </div>
        {% endpaginate %}
      {% elsif viewblog == "column" %}
        {% paginate blog.articles by section.settings.page_show_column %}
          <div class="blog--list blog--column-view">
            <div class="row">
              {% for article in blog.articles %}
                <div class="article--listing col-lg-6 mb-30">
                  <div class="block_content">
                    <div class="article__image mb-30">
                      {% if article.image %}
                        <a href="{{ article.url }}" class="article__list-image-container">
                          {% render 'nov-aspect-image', image: article.image, aspect: 66.67 %}
                        </a>
                      {% endif %}
                    </div>
                    <div class="article-body text-center">
                      <h2 class="article__title"><a href="{{ article.url }}">{{ article.title }}</a></h2>
                      
                      <div class="article__excerpt">
                        {% if article.excerpt.size > 0 %}
                          {{ article.excerpt | strip_html | truncate: 170 }}
                        {% else %}
                          {{ article.content | strip_html | truncate: 170 }}
                        {% endif %}
                      </div>
                      <a href="{{ article.url }}" class="btn">{{ 'blogs.article.readmore' | t }}</a>

                      <div class="article__info">
                        {% if section.settings.blog_show_date %}
                          <span class="article__date">
                            <i class="zmdi zmdi-calendar-note"></i>{{ article.published_at | time_tag: format: 'month_day_year' }}
                          </span>
                        {% endif %}

                        {% if section.settings.blog_show_author %}
                          <span class="article__author"><i class="zmdi zmdi-account"></i>{{ article.author }}</span>
                        {% endif %}

                        {% if section.settings.blog_show_comment %}
                          {% if blog.comments_enabled? %}
                            <span class="article__countcomment">
                              <i class="zmdi zmdi-comments"></i>{{ 'blogs.comments.comments_with_count' | t: count: article.comments_count }}
                            </span>
                          {% endif %}
                        {% endif %}
                      </div>
                    </div>
                  </div>
                </div>
              {% endfor %}
            </div>

            {% if paginate.pages > 1 %}
            <div class="nov-pagination d-flex align-items-center justify-content-center">
              {% render 'pagination', paginate: paginate %}
            </div>
            {% endif %}
          </div>
        {% endpaginate %}
      {% else %}
        {% paginate blog.articles by section.settings.page_show_grid %}
          <div class="blog--list blog--grid-view">
            {% for article in blog.articles %}
              <div class="article--listing mb-60">
                <div class="article__image">
                  {% if article.image %}
                    <a href="{{ article.url }}" class="article__list-image-container">
                      {% if viewtype == 'withoutsidebar' %}
                        {% render 'nov-aspect-image', image: article.image, aspect: 56.5 %}
                      {% else %}
                        {% render 'nov-aspect-image', image: article.image, aspect: 56.7 %}
                      {% endif %}
                    </a>
                  {% endif %}
                </div>
                <div class="article-body">
                  <h2 class="article__title"><a href="{{ article.url }}">{{ article.title }}</a></h2>
                  <div class="article__info">
                    {% if section.settings.blog_show_date %}
                      <span class="article__date">
                        <i class="zmdi zmdi-calendar-note"></i>{{ article.published_at | time_tag: format: 'month_day_year' }}
                      </span>
                    {% endif %}

                    {% if section.settings.blog_show_author %}
                      <span class="article__author"><i class="zmdi zmdi-account"></i>{{ article.author }}</span>
                    {% endif %}

                    {% if section.settings.blog_show_comment %}
                      {% if blog.comments_enabled? %}
                        <span class="article__countcomment">
                          <i class="zmdi zmdi-comments"></i>{{ 'blogs.comments.comments_with_count' | t: count: article.comments_count }}
                        </span>
                      {% endif %}
                    {% endif %}
                  </div>

                  <div class="article__excerpt">
                    {% if article.excerpt.size > 0 %}
                      {{ article.excerpt | strip_html | truncate: 350 }}
                    {% else %}
                      {{ article.content | strip_html | truncate: 350 }}
                    {% endif %}
                  </div>
                  <a href="{{ article.url }}" class="btn">{{ 'blogs.article.readmore' | t }}</a>
                </div>
              </div>
            {% endfor %}
            {% if paginate.pages > 1 %}
              <div class="nov-pagination d-flex align-items-center justify-content-center pt-40">
                {% render 'pagination', paginate: paginate %}
              </div>
            {% endif %}
          </div>
        {% endpaginate %}
      {% endif %}
    </div>
  </div>
</div>
{% schema %}
  {
    "name": "Blog pages",
    "settings": [
      {
        "type": "select",
        "id": "layout",
        "label": "Layout",
        "default": "list",
        "options": [
          {
            "value": "grid",
            "label": "Grid"
          },
          {
            "value": "list",
            "label": "List"
          },
          {
            "value": "column",
            "label": "Column"
          }
        ]
      },
      {
        "type": "checkbox",
        "id": "blog_show_author",
        "label": "Show author",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "blog_show_date",
        "label": "Show date",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "blog_show_comment",
        "label": "Show Comment",
        "default": true
      },
      {
        "type": "range",
        "id": "page_show_list",
        "min": 1,
        "max": 15,
        "step": 1,
        "label": "Number of post per page List",
        "default": 3
      },
      {
        "type": "range",
        "id": "page_show_column",
        "min": 1,
        "max": 15,
        "step": 1,
        "label": "Number of post per page Column",
        "default": 3
      },
      {
        "type": "range",
        "id": "page_show_grid",
        "min": 1,
        "max": 15,
        "step": 1,
        "label": "Number of post per page Grid",
        "default": 3
      }
    ],
    "blocks": [
      {
        "type": "block_search",
        "name": "Block Search",
        "settings": [
          {
            "type": "text",
            "id": "block_class",
            "label": "Class"
          }
        ]
      },
      {
        "type": "block_categories",
        "name": "Categories Product",
        "settings": [
          {
            "type": "text",
            "id": "sidebar_categories_title",
            "label": "Title",
            "default": "Categories"
          },
          {
            "type": "text",
            "id": "sidebar_categories_class",
            "label": "Class"
          },
          {
            "type": "link_list",
            "id": "sidebar_categories_menu",
            "label": "Choose Menu",
            "info": "Choose menu for block. [Add new menu here](/admin/menus)"
          }
        ]
      },
      {
        "type": "block_recentpost",
        "name": "Block Recent Post",
        "settings": [
          {
            "type": "text",
            "id": "block_title",
            "label": "Title",
            "default": "Recent post"
          },
          {
            "type": "text",
            "id": "block_class",
            "label": "Class"
          },
          {
            "type": "range",
            "id": "number_show",
            "min": 2,
            "max": 10,
            "step": 1,
            "label": "Number Show",
            "default": 2,
            "info": "Select number post show"
          },
          {
            "type": "checkbox",
            "id": "show_date",
            "label": "Show date",
            "default": true
          },
          {
            "type": "checkbox",
            "id": "show_comment",
            "label": "Show Comment",
            "default": true
          },
          {
            "type": "checkbox",
            "id": "show_author",
            "label": "Show Author",
            "default": false
          }
        ]
      },
      {
        "type": "block_blogtags",
        "name": "Block Blog Tags",
        "settings": [
          {
            "type": "text",
            "id": "block_title",
            "label": "Title",
            "default": "Blog Tags"
          },
          {
            "type": "select",
            "id": "btn_type",
            "label": "Tag type",
            "default": "btn-primary",
            "options": [
              { "value": "btn-primary", "label": "Primary" },
              { "value": "btn-secondary", "label": "Secondary" }
            ]
          },
          {
            "type": "color_scheme",
            "id": "tag_color",
            "label": "Tag color",
            "default": "background-1"
          },
          {
            "type": "text",
            "id": "block_class",
            "label": "Class"
          },
          {
            "type": "range",
            "id": "number_show",
            "min": 2,
            "max": 20,
            "step": 1,
            "label": "Number Show",
            "default": 2,
            "info": "Select number tags show"
          }
        ]
      },
      {
        "type": "block_banner",
        "name": "Block Banner",
        "settings": [
          {
            "type": "text",
            "id": "banner_title",
            "label": "Title"
          },
          {
            "type": "text",
            "id": "banner_class",
            "label": "Class"
          },
          {
            "type": "image_picker",
            "id": "banner_image",
            "label": "Banner image"
          },
          {
            "type": "range",
            "id": "radius",
            "min": 0,
            "max": 100,
            "step": 1,
            "unit": "px",
            "label": "Border radius image",
            "default": 0
          },
          {
            "id": "banner_link",
            "type": "url",
            "label": "Banner button link"
          }
        ]
      },
      {
        "type": "@app"
      }
    ]
  }
{% endschema %}
<style>
/* ===== MeineDampfwelt – Blog Overrides (Dark) ===== */
:root{
  --mdw-brand:#ABCA20;
  --mdw-bg:#17171A;
  --mdw-card:#1B1F26;           /* Karten/Sidebar */
  --mdw-text:#E9EDF3;
  --mdw-sub:#9AA3B2;
  --mdw-border:#2A2F3A;
}

/* Grundfläche dunkel NUR für Blog-Inhalt, nicht für Header */
.template-blog{
  background: var(--mdw-bg);
  color: var(--mdw-text);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";
}

/* Container nur im Blog-Bereich dunkel, Header bleibt wie im Theme */
.template-blog .blog-view-leftsidebar,
.template-blog .blog-view-rightsidebar,
.template-blog .blog-view-withoutsidebar{
  background: var(--mdw-bg);
}


/* ---------- SIDEBAR (dunkel + lesbar) ---------- */
.sidebar-article .sidebar-blog__item{
  background: var(--mdw-card);
  border: 1px solid var(--mdw-border);
  color: var(--mdw-text);
}
.sidebar-article .sidebar-blog__item .title-block{
  color: var(--mdw-text);
  border-bottom: 1px solid var(--mdw-border);
}
.sidebar-article,
.sidebar-article *{
  color: var(--mdw-text);
}
.sidebar-article a{ color: var(--mdw-text); text-decoration: none; }
.sidebar-article a:hover{ color: var(--mdw-brand); }

/* Kategorien-Liste Punkte/Trenner etwas sichtbarer */
.sidebar-article .post-item .post__info,
.sidebar-article .post-item .post__date{
  color: var(--mdw-sub);
}
.recentpost__sidebar .post-item:not(:last-child){
  border-bottom: 1px dashed rgba(255,255,255,.08);
}

/* ---------- SUCHFELD in der Sidebar ---------- */
.search__sidebar{
  background: var(--mdw-card) !important;
  border: 1px solid var(--mdw-border);
  border-radius: 12px;
}
.search__sidebar .search__input{
  background: #12151B;
  border: 1px solid var(--mdw-border);
  color: var(--mdw-text);
}
.search__sidebar .search__input::placeholder{
  color: var(--mdw-sub);
}
.search__sidebar .search__submit{
  background: var(--mdw-brand);
  border-color: rgba(0,0,0,.35);
  color: #0D1206;
}
.search__sidebar .search__submit:hover{
  filter: brightness(0.9);
}

/* ---------- LISTEN/ARTIKEL-KARTEN ---------- */
.template-blog .article--listing{
  background: transparent; /* Karten selbst sind im Theme gerahmt – Umrandung dunkler machen: */
  border-color: var(--mdw-border);
}
.template-blog .article--listing .article__title a{
  color: var(--mdw-text);
}
.template-blog .article--listing .article__excerpt{
  color: var(--mdw-sub);
}
.template-blog .blog--grid-view .article--listing .article__info,
.template-blog .blog--list-view .article--listing{
  border-color: var(--mdw-border);
}

/* ---------- „Zuletzt veröffentlicht“ (Sidebar-Heading) ---------- */
.sidebar-blog__item .title-block .title_block,
.sidebar-blog__item .title-block h3,
.sidebar-blog__item .title-block .h3{
  color: var(--mdw-text) !important;
}



/* ---------- Buttons (Read more) konsistent ---------- */
.template-blog .btn{
  background: transparent;
  border: 1px solid rgba(171,202,32,.45);
  color: var(--mdw-brand);
  border-radius: 12px;
}
.template-blog .btn:hover{
  background: rgba(171,202,32,.12);
}

/* ---------- Feinheiten ---------- */
.template-blog .article__author,
.template-blog .article__countcomment,
.template-blog .article__date{
  color: var(--mdw-sub);
}
.template-blog .article__image{ border-radius: 10px; }

/* Entfernt sehr helle Standardrahmen in Widgets, falls vom Theme gesetzt */
.sidebar-blog__item,
.search__sidebar,
.recentpost__sidebar .post-item{
  box-shadow: none;
}
</style>
